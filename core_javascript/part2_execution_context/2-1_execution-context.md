# Chapter 02 - 실행 컨텍스트

### [02-1] Execution context

### 실행 컨텍스트?

- 실행할 코드에 제공할 환경 정보들을 모아놓은 객체
- 자바스크립트의 동적 언어로서의 성격을 가장 잘 파악할 수 있는 개념
- JS 에서 가장 중요한 핵심 개념 중 하나

#### [02-1-1] 실행 컨텍스트란?

- stack : 출입구가 하나 뿐인 깊은 우물 같은 데이터 구조
- que : 양쪽이 모두 열려있는 파이프 같은 데이터 구조

- 실행 컨텍스트!
  - 실행할 코드에 제공할 환경 정보들을 모아놓은 객체
  - 동일한 환경에 있는 코드들을 실행할 때 필요한 환경 정보들을 모아 컨텍스트를 구성하고 이를 콜 스택(call stack)에 쌓아올렸다가, 가장 위에 쌓여있는 컨텍스트와 관련있는 코드들을 실행하는 식으로 전체 코드의 환경과 순서를 보장함
  - ' 동일한 환경? ' : 하나의 실행 컨텍스트를 구성할 수 있는 방법으로 전역공간, eval() 함수, 함수 등이 있음
  - eval()을 제외하면 우리가 흔히 실행 컨텍스트를 구성하는 방법은 함수를 실행하는 것 뿐!

```javascript
// -------------------------------------- (1)
var a = 1;
function outer() {
  function inner() {
    console.log(a); // undefined
    var a = 3;
  }
  inner(); // --------------------------- (2)
  console.log(a); // 1
}

outer(); // ----------------------------- (3)
console.log(a); // 1
```

- 흐름을 알아보자
  1. JS code를 실행하는 순간(1) 전역 컨텍스트가 콜 스택에 담김
  2. 전역 컨텍스트와 관련된 코드들을 순차적으로 진행
  3. (3)에서 outer 함수를 호출하면 JS 엔진은 outer에 대한 환경 정보를 수집해 outer 실행 컨텍스트를 생성한 후 콜 스택에 담음
  4. 콜스택의 가장 사단에 outer 실행 컨텍스트가 놓인 상태가 되었으니, 전역 컨텍스트의 실행을 일시중단하고 대신 outer 실행 컨텍스트와 관련된 코드인 outer 함수 내부의 코드들을 순차적으로 실행
  5. (2) 에서 inner 함수의 실행 컨텍스트가 콜 스택의 가장 위에 담기면 outer 컨텍스트와 관련된 코드의 실행은 중단되며 inner 함수 내부의 코드를 순서대로 진행
  6. inner 함수 내부에서 a 변수에 3을 할당하고 나면, inner 함수 실행 종료됨과 동시에 실행 컨텍스트가 콜 스택에서 제거됨
  7. 그 후, 아래에 있던 outer 컨텍스트가 콜 스택의 맨 위에 존재하게 되므로 중단했던 (2)의 다음 줄부터 이어서 실행
  8. a 변수의 값을 출력하고 나면 outer 함수의 실행이 종료되어 outer 실행 컨텍스트그ㅏ 콜 스택에서 제거되고, 콜 스택에는 전역 컨텍스트만 남게됨
  9. 그 후, 실행을 중단했던 (3) 의 다음줄 부터 이어서 실행
  10. 더 이상 전역공간에 실행할 코드가 남지 않으면, 전역 컨텍스트도 제거되고 종료.
